<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
		http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd"
  logicalFilePath="./liquibase/db-data-lbts.xml">

	<!-- ALWAYS USE A UNIQUE IDENTIFIER of format id="yyyymmdd-hhmm" eg: id="20140225-1815" -->
	<!-- ALWAYS UPDATE YOUR LOCAL REPO FROM GITHUB AND VERIFY YOUR id IS UNIQUE -->
	<!-- NEVER DELETE OR MODIFY EXISTING CHANGE SETS - instead add new change sets 
		 reversing the previous ones if you need to change or delete info from another changeset-->

	<changeSet id="20150114-0956" author="danfuterman">
		<comment>Add donation types</comment>
		<insert tableName = "DonationType">
			<column name="donationType" value="Voluntary"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "DonationType">
			<column name="donationType" value="Family"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "DonationType">
			<column name="donationType" value="Autologous"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "DonationType">
			<column name="donationType" value="Other"/>
			<column name="isDeleted" value="0"/>
		</insert>
	</changeSet>

	<!-- Updated (timler): for #294 (refactoring) -->
	<changeSet id="20150817-1552" author="danfuterman">
	    <preConditions onFail="MARK_RAN">
		    <sqlCheck expectedResult="0"> 
				<![CDATA[
				SELECT count(*) FROM ComponentTypeCombination WHERE id = 1;
				]]>
			</sqlCheck>
 		</preConditions>
		<comment>Add component type combinations</comment>
		<insert tableName = "ComponentTypeCombination">
			<column name="id" value="1"/>
			<column name="combinationName" value="Whole Blood"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ComponentTypeCombination">
			<column name="id" value="2"/>
			<column name="combinationName" value="PRC-CPDA, FFP"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ComponentTypeCombination">
			<column name="id" value="3"/>
			<column name="combinationName" value="PRC-CPDA, FP"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ComponentTypeCombination">
			<column name="id" value="4"/>
			<column name="combinationName" value="WB Poor Platelets, PC-24H"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ComponentTypeCombination">
			<column name="id" value="5"/>
			<column name="combinationName" value="PRC-SAGM, FFP, PC"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ComponentTypeCombination">
			<column name="id" value="6"/>
			<column name="combinationName" value="PRC-SAGM, FFP"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ComponentTypeCombination">
			<column name="id" value="7"/>
			<column name="combinationName" value="PRC-SAGM, FP"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ComponentTypeCombination">
			<column name="id" value="8"/>
			<column name="combinationName" value="3 X PRC-Paed-CPDA, FFP"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ComponentTypeCombination">
			<column name="id" value="9"/>
			<column name="combinationName" value="FFP-Apheresis, PC-Apheresis"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ComponentTypeCombination">
			<column name="id" value="10"/>
			<column name="combinationName" value="FFP Apheresis, 2 X PC-Apheresis"/>
			<column name="isDeleted" value="0"/>
		</insert>
	</changeSet>

	<changeSet id="20141117-0945" author="srikanthmalyala">
		<comment>Add contact method types</comment>
		<insert tableName = "ContactMethodType">
			<column name="contactMethodType" value="None"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ContactMethodType">
			<column name="contactMethodType" value="Phone"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ContactMethodType">
			<column name="contactMethodType" value="SMS"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ContactMethodType">
			<column name="contactMethodType" value="Email"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ContactMethodType">
			<column name="contactMethodType" value="Mail"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName = "ContactMethodType">
			<column name="contactMethodType" value="Do not contact"/>
			<column name="isDeleted" value="0"/>
		</insert>
	</changeSet>
	
	<changeSet id="20131024-1527" author="gtlnikita">
		<comment>Add deferral reasons</comment>
		<insert tableName="DeferralReason">
			<column name="reason" value="High risk behaviour"/>
			<column name="isDeleted" value="0"/>
			<column name="type" value="NORMAL" />
			<column name="durationType" value="TEMPORARY" />
		</insert>
		<insert tableName="DeferralReason">
			<column name="reason" value="Low weight"/>
			<column name="isDeleted" value="0"/>
			<column name="type" value="NORMAL" />
			<column name="durationType" value="TEMPORARY" />
		</insert>
		<insert tableName="DeferralReason">
			<column name="reason" value="Low haemoglobin"/>
			<column name="isDeleted" value="0"/>
			<column name="type" value="NORMAL" />
			<column name="durationType" value="TEMPORARY" />
		</insert>
		<insert tableName="DeferralReason">
			<column name="reason" value="Other reasons"/>
			<column name="isDeleted" value="0"/>
			<column name="type" value="NORMAL" />
			<column name="durationType" value="TEMPORARY" />
		</insert>
		<insert tableName="DeferralReason">
			<column name="reason" value="Other medical conditions"/>
			<column name="isDeleted" value="0"/>
			<column name="type" value="NORMAL" />
			<column name="durationType" value="TEMPORARY" />
		</insert>
		<insert tableName="DeferralReason">
			<column name="reason" value="Travel history"/>
			<column name="isDeleted" value="0"/>
			<column name="type" value="NORMAL" />
			<column name="durationType" value="TEMPORARY" />
		</insert>
	</changeSet>
	
	<!-- Updated (timler): for #294 (refactoring) -->
	<changeSet id="20140818-0410" author="gtlnikita">
	    <preConditions onFail="MARK_RAN">
		    <sqlCheck expectedResult="0"> 
				<![CDATA[
				SELECT count(*) FROM ComponentStatusChangeReason WHERE statusChangeReason = "Incomplete Donation";
				]]>
			</sqlCheck>
 		</preConditions>
		<comment>Add component discard reasons</comment>
		<insert tableName="ComponentStatusChangeReason">
			<column name="statusChangeReason" value="Incomplete Donation"/>
			<column name="category" value="DISCARDED"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName="ComponentStatusChangeReason">
			<column name="statusChangeReason" value="Processing Problems"/>
			<column name="category" value="DISCARDED"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName="ComponentStatusChangeReason">
			<column name="statusChangeReason" value="Passed Expiry Dates"/>
			<column name="category" value="DISCARDED"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName="ComponentStatusChangeReason">
			<column name="statusChangeReason" value="Reactive FOR TTIs"/>
			<column name="category" value="DISCARDED"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName="ComponentStatusChangeReason">
			<column name="statusChangeReason" value="Storage Problems"/>
			<column name="category" value="DISCARDED"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName="ComponentStatusChangeReason">
			<column name="statusChangeReason" value="Transport Problems"/>
			<column name="category" value="DISCARDED"/>
			<column name="isDeleted" value="0"/>
		</insert>
	</changeSet>

	<!-- Updated (timler): for #294 (refactoring) -->
	<changeSet id="20150818-0411" author="danfuterman">
	    <preConditions onFail="MARK_RAN">
		    <sqlCheck expectedResult="0"> 
				<![CDATA[
				SELECT count(*) FROM ComponentStatusChangeReason WHERE statusChangeReason = "Expired";
				]]>
			</sqlCheck>
 		</preConditions>
		<comment>Add component return and split reasons</comment>
		<insert tableName="ComponentStatusChangeReason">
			<column name="statusChangeReason" value="Expired"/>
			<column name="category" value="RETURNED"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName="ComponentStatusChangeReason">
			<column name="statusChangeReason" value="Not required"/>
			<column name="category" value="RETURNED"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName="ComponentStatusChangeReason">
			<column name="statusChangeReason" value="Incorrect Component Sent"/>
			<column name="category" value="RETURNED"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName="ComponentStatusChangeReason">
			<column name="statusChangeReason" value="Did not crossmatch with patient sample"/>
			<column name="category" value="RETURNED"/>
			<column name="isDeleted" value="0"/>
		</insert>
		<insert tableName="ComponentStatusChangeReason">
			<column name="statusChangeReason" value="Split"/>
			<column name="category" value="SPLIT"/>
			<column name="isDeleted" value="0"/>
		</insert>
	</changeSet>

	<changeSet id="20141117-1054" author="srikanthmalyala">
		<comment>Add preferred languages</comment>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="1"></column>
			 <column name="preferredLanguage" value="English"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="2"></column>
			 <column name="preferredLanguage" value="French"></column> 
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="3"></column>
			  <column name="preferredLanguage" value="Portuguese"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="4"></column>
			 <column name="preferredLanguage" value="Spanish"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="5"></column>
			 <column name="preferredLanguage" value="Arabic"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="6"></column>
			 <column name="preferredLanguage" value="Berber"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="7"></column>
			 <column name="preferredLanguage" value="Amharic"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="8"></column>
			 <column name="preferredLanguage" value="Tigrinya"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="9"></column>
			 <column name="preferredLanguage" value="Setswana"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="10"></column>
			 <column name="preferredLanguage" value="Swahili"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="11"></column>
			 <column name="preferredLanguage" value="Comorian"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="12"></column>
			 <column name="preferredLanguage" value="Chichewa"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="13"></column>
			 <column name="preferredLanguage" value="Kinyarwanda"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="14"></column>
			 <column name="preferredLanguage" value="Kirundi"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="15"></column>
			 <column name="preferredLanguage" value="Sango"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="16"></column>
			 <column name="preferredLanguage" value="Swati"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="17"></column>
			 <column name="preferredLanguage" value="Malagasy"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="18"></column>
			 <column name="preferredLanguage" value="Seychellois"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="19"></column>
			 <column name="preferredLanguage" value="Mauritian"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="20"></column>
			 <column name="preferredLanguage" value="Shona"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="21"></column>
			 <column name="preferredLanguage" value="Sesotho"></column>
		</insert>
		<insert tableName="PreferredLanguage">
			 <column name="id" value="22"></column>
			 <column name="preferredLanguage" value="Afrikaans"></column>
		</insert>
	</changeSet>

	<changeSet id="20141117-1121" author="srikanthmalyala">
		<comment>Add identity types</comment>
		<insert tableName="IdType">
			<column name="id" value="1"></column>
			<column name="idType" value="National Id"></column>
		</insert>
		<insert tableName="IdType">
			<column name="id" value="2"></column>
			<column name="idType" value="Passport Number"></column>
		</insert>
		<insert tableName="IdType">
			<column name="id" value="3"></column>
			<column name="idType" value="License Number"></column>
		</insert>
	</changeSet>

	<!--  NOT USED FOR BETA-RELEASE
	<changeSet id="20141117-1128" author="srikanthmalyala">
		<comment>Add donor code groups</comment>
		<insert tableName="DonorCodeGroup">
			<column name="id" value="1"></column>
			<column name="donorCodeGroup" value="Test Only"></column>
		</insert>
		<insert tableName="DonorCodeGroup">
			<column name="id" value="2"></column>
			<column name="donorCodeGroup" value="Do Not Bleed"></column>
		</insert>
	</changeSet>
	
	<changeSet id="20141117-1133" author="srikanthmalyala">
		<comment>Add donor codes</comment>
		<insert tableName="DonorCode">
			<column name="id" value="1"></column>
			<column name="donorCode" value="Blood group antibody"></column>
			<column name="donorCodeGroupId" value="1"></column>   
		</insert>
		<insert tableName="DonorCode">
			<column name="id" value="2"></column>
			<column name="donorCode" value="Follow up samples required"></column>
			<column name="donorCodeGroupId" value="1"></column>   
		</insert>
		<insert tableName="DonorCode">
			<column name="id" value="3"></column>
			<column name="donorCode" value="Lab query"></column>
			<column name="donorCodeGroupId" value="1"></column>   
		</insert>
		<insert tableName="DonorCode">
			<column name="id" value="4"></column>
			<column name="donorCode" value="Biological false positive"></column>
			<column name="donorCodeGroupId" value="2"></column>   
		</insert>
		<insert tableName="DonorCode">
			<column name="id" value="5"></column>
			<column name="donorCode" value="For counseling – HCV"></column>
			<column name="donorCodeGroupId" value="2"></column>   
		</insert>
		<insert tableName="DonorCode">
			<column name="id" value="6"></column>
			<column name="donorCode" value="For counseling – HIV"></column>
			<column name="donorCodeGroupId" value="2"></column>   
		</insert>
		<insert tableName="DonorCode">
			<column name="id" value="7"></column>
			<column name="donorCode" value="TTI Reactive"></column>
			<column name="donorCodeGroupId" value="2"></column>   
		</insert>
	</changeSet>
	
	-->

	<changeSet id="20141117-1141" author="srikanthmalyala">
		<comment>Add address types</comment>
		<insert tableName="AddressType">
			<column name="id" value="1"></column>
			<column name="preferredAddressType" value="Home Address"></column>
		</insert>
		<insert tableName="AddressType">
			<column name="id" value="2"></column>
			<column name="preferredAddressType" value="Work Address"></column>
		</insert>
		<insert tableName="AddressType">
			<column name="id" value="3"></column>
			<column name="preferredAddressType" value="Postal Address"></column>
		</insert>
	</changeSet>
    
    <changeSet id="20150922-1100" author="danfuterman">
		<comment>Add default adverse event types</comment>
		<insert tableName="AdverseEventType">
			<column name="name" value="Haematoma"></column>
			<column name="description" value="Swelling of clotted blood within the tissues"></column>
		</insert>
		<insert tableName="AdverseEventType">
			<column name="name" value="Arterial puncture"></column>
			<column name="description" value="Needle inserted into artery rather than a vein"></column>
		</insert>
		<insert tableName="AdverseEventType">
			<column name="name" value="Nerve injury"></column>
			<column name="description" value="An injury to nerve tissue as a result of donating blood"></column>
		</insert>
		<insert tableName="AdverseEventType">
			<column name="name" value="Thrombophlebitis"></column>
			<column name="description" value="Inflammation of the vein related to a blood clot"></column>
		</insert>
		<insert tableName="AdverseEventType">
			<column name="name" value="Allergy"></column>
			<column name="description" value="Allergic reaction as a result of donating blood"></column>
		</insert>
		<insert tableName="AdverseEventType">
			<column name="name" value="Vasovagal"></column>
			<column name="description" value="Fainting as a result of donating blood"></column>
		</insert>
		<insert tableName="AdverseEventType">
			<column name="name" value="Hyperventilation"></column>
			<column name="description" value="Hyperventilation as a result of donating blood"></column>
		</insert>
		<insert tableName="AdverseEventType">
			<column name="name" value="Convulsions"></column>
			<column name="description" value="Involuntary convulsions as a result of donating blood"></column>
		</insert>
		<insert tableName="AdverseEventType">
			<column name="name" value="Accident"></column>
			<column name="description" value="An accident as a result of donating blood"></column>
		</insert>
		<insert tableName="AdverseEventType">
			<column name="name" value="Nausea"></column>
			<column name="description" value="Nausea as a result of donating blood"></column>
		</insert>
		<insert tableName="AdverseEventType">
			<column name="name" value="Other"></column>
			<column name="description" value="Any other reaction as a result of donating blood"></column>
		</insert>
	</changeSet>

    <changeSet id="20151005-0925" author="bausmeier">
        <insert tableName="GeneralConfig">
            <column name="name"
                value="testing.deferDonorsWithNegConfirmatoryOutcomes"></column>
            <column name="value" value="true"></column>
            <column name="description"
                value="Defer donors with a POS TTI test outcome, where all confirmatory outcomes are NEG"></column>
            <column name="dataType_id" value="4"></column>
        </insert>
    </changeSet>
    
    <changeSet id="20151005-1101" author="bausmeier">

        <comment>HIV confirmatory test</comment>
        <insert tableName="BloodTest">
            <column name="id" value="29"></column>
            <column name="bloodTestType" value="CONFIRMATORY_TTI"></column>
            <column name="category" value="TTI"></column>
            <column name="context" value="RECORD_TTI_TESTS"></column>
            <column name="isActive" value="1"></column>
            <column name="isEmptyAllowed" value="0"></column>
            <column name="negativeResults" value="NEG"></column>
            <column name="positiveResults" value="POS"></column>
            <column name="rankInCategory" value="2"></column>
            <column name="testName" value="HIV Confirmatory 3"></column>
            <column name="testNameShort" value="HIV Conf 3"></column>
            <column name="validResults" value="POS,NEG"></column>
            <column name="isDeleted" value="0"></column>
        </insert>
        <insert tableName="BloodTestingRule">
            <column name="bloodTestsIds" value="29"></column>
            <column name="category" value="TTI"></column>
            <column name="donationFieldChanged" value="TTISTATUS"></column>
            <column name="context" value="RECORD_TTI_TESTS"></column>
            <column name="isActive" value="1"></column>
            <column name="markSampleAsUnsafe" value="0"></column>
            <column name="newInformation" value="TTI_UNSAFE"></column>
            <column name="pattern" value="POS"></column>
            <column name="subCategory" value="TTI"></column>
        </insert>

        <comment>HBV confirmatory test</comment>
        <insert tableName="BloodTest">
            <column name="id" value="30"></column>
            <column name="bloodTestType" value="CONFIRMATORY_TTI"></column>
            <column name="category" value="TTI"></column>
            <column name="context" value="RECORD_TTI_TESTS"></column>
            <column name="isActive" value="1"></column>
            <column name="isEmptyAllowed" value="0"></column>
            <column name="negativeResults" value="NEG"></column>
            <column name="positiveResults" value="POS"></column>
            <column name="rankInCategory" value="2"></column>
            <column name="testName" value="HBV Confirmatory 3"></column>
            <column name="testNameShort" value="HBV Conf 3"></column>
            <column name="validResults" value="POS,NEG"></column>
            <column name="isDeleted" value="0"></column>
        </insert>
        <insert tableName="BloodTestingRule">
            <column name="bloodTestsIds" value="30"></column>
            <column name="category" value="TTI"></column>
            <column name="donationFieldChanged" value="TTISTATUS"></column>
            <column name="context" value="RECORD_TTI_TESTS"></column>
            <column name="isActive" value="1"></column>
            <column name="markSampleAsUnsafe" value="0"></column>
            <column name="newInformation" value="TTI_UNSAFE"></column>
            <column name="pattern" value="POS"></column>
            <column name="subCategory" value="TTI"></column>
        </insert>

        <comment>HCV confirmatory test</comment>
        <insert tableName="BloodTest">
            <column name="id" value="31"></column>
            <column name="bloodTestType" value="CONFIRMATORY_TTI"></column>
            <column name="category" value="TTI"></column>
            <column name="context" value="RECORD_TTI_TESTS"></column>
            <column name="isActive" value="1"></column>
            <column name="isEmptyAllowed" value="0"></column>
            <column name="negativeResults" value="NEG"></column>
            <column name="positiveResults" value="POS"></column>
            <column name="rankInCategory" value="2"></column>
            <column name="testName" value="HCV Confirmatory 3"></column>
            <column name="testNameShort" value="HCV Conf 3"></column>
            <column name="validResults" value="POS,NEG"></column>
            <column name="isDeleted" value="0"></column>
        </insert>
        <insert tableName="BloodTestingRule">
            <column name="bloodTestsIds" value="31"></column>
            <column name="category" value="TTI"></column>
            <column name="donationFieldChanged" value="TTISTATUS"></column>
            <column name="context" value="RECORD_TTI_TESTS"></column>
            <column name="isActive" value="1"></column>
            <column name="markSampleAsUnsafe" value="0"></column>
            <column name="newInformation" value="TTI_UNSAFE"></column>
            <column name="pattern" value="POS"></column>
            <column name="subCategory" value="TTI"></column>
        </insert>

        <comment>Syphilis confirmatory test</comment>
        <insert tableName="BloodTest">
            <column name="id" value="32"></column>
            <column name="bloodTestType" value="CONFIRMATORY_TTI"></column>
            <column name="category" value="TTI"></column>
            <column name="context" value="RECORD_TTI_TESTS"></column>
            <column name="isActive" value="1"></column>
            <column name="isEmptyAllowed" value="0"></column>
            <column name="negativeResults" value="NEG"></column>
            <column name="positiveResults" value="POS"></column>
            <column name="rankInCategory" value="2"></column>
            <column name="testName" value="Syphilis Confirmatory 3"></column>
            <column name="testNameShort" value="Syphilis Conf 3"></column>
            <column name="validResults" value="POS,NEG"></column>
            <column name="isDeleted" value="0"></column>
        </insert>
        <insert tableName="BloodTestingRule">
            <column name="bloodTestsIds" value="32"></column>
            <column name="category" value="TTI"></column>
            <column name="donationFieldChanged" value="TTISTATUS"></column>
            <column name="context" value="RECORD_TTI_TESTS"></column>
            <column name="isActive" value="1"></column>
            <column name="markSampleAsUnsafe" value="0"></column>
            <column name="newInformation" value="TTI_UNSAFE"></column>
            <column name="pattern" value="POS"></column>
            <column name="subCategory" value="TTI"></column>
        </insert>
        
        <sql>
            UPDATE BloodTestingRule SET pendingTestsIds = '29' WHERE id IN (9, 10);
            UPDATE BloodTestingRule SET pendingTestsIds = '30' WHERE id IN (13, 14);
            UPDATE BloodTestingRule SET pendingTestsIds = '31' WHERE id IN (17, 18);
            UPDATE BloodTestingRule SET pendingTestsIds = '32' WHERE id IN (21, 22);
        </sql>
    </changeSet>
    
    <changeSet id="20151006-1200" author="bausmeier">
    
        <update tableName="BloodTest">
            <column name="flagComponentsForDiscard" value="1" type="tinyint(1)"></column>
            <where>category = 'TTI'</where>
        </update>
    
        <insert tableName="BloodTest">
            <column name="id" value="33"></column>
            <column name="bloodTestType" value="BASIC_BLOODTYPING"></column>
            <column name="category" value="BLOODTYPING"></column>
            <column name="context" value="RECORD_BLOOD_TYPING_TESTS"></column>
            <column name="isActive" value="1"></column>
            <column name="isEmptyAllowed" value="0"></column>
            <column name="negativeResults" value="NEG"></column>
            <column name="positiveResults" value="POS"></column>
            <column name="rankInCategory" value="7"></column>
            <column name="testName" value="Antibody Screen"></column>
            <column name="testNameShort" value="AbScr"></column>
            <column name="validResults" value="POS,NEG"></column>
            <column name="isDeleted" value="0"></column>
            <column name="flagComponentsForDiscard" value="1"></column>
        </insert>
    </changeSet>

    <changeSet id="20151023-1015" author="bausmeier">
        <insert tableName="GeneralConfig">
            <column name="name" value="components.createInitialComponents"></column>
            <column name="value" value="true"></column>
            <column name="description"
                value="Enable creation of initial components. Can be disabled in the case where components are not managed by the system."></column>
            <column name="dataType_id" value="4"></column>
        </insert>
    </changeSet>
    
    <changeSet id="20151127-0841" author="danfuterman">
		<comment>Add Deferral Reason default durations</comment>
		<update tableName="DeferralReason">
            <column name="defaultDuration" value="365" type="smallint(5)"></column>
            <where>reason = 'High risk behaviour'</where>
        </update>
        <update tableName="DeferralReason">
            <column name="defaultDuration" value="90" type="smallint(5)"></column>
            <where>reason = 'Low weight'</where>
        </update>
        <update tableName="DeferralReason">
            <column name="defaultDuration" value="90" type="smallint(5)"></column>
            <where>reason = 'Low haemoglobin'</where>
        </update>
        <update tableName="DeferralReason">
            <column name="defaultDuration" value="90" type="smallint(5)"></column>
            <where>reason = 'Other reasons'</where>
        </update>
        <update tableName="DeferralReason">
            <column name="defaultDuration" value="180" type="smallint(5)"></column>
            <where>reason = 'Other medical conditions'</where>
        </update>
        <update tableName="DeferralReason">
            <column name="defaultDuration" value="90" type="smallint(5)"></column>
            <where>reason = 'Travel history'</where>
        </update>
	</changeSet>


	<changeSet id="20160112-1030" author="debonair">
		<update tableName="Donation">
			<column name="haemoglobinLevel" value="Fail" type="varchar(20)"></column>
			<where>haemoglobinLevel = 'High'</where>
		</update>
		<update tableName="Donation">
			<column name="haemoglobinLevel" value="Fail" type="varchar(20)"></column>
			<where>haemoglobinLevel = 'Low'</where>
		</update>
		<update tableName="Donation">
			<column name="haemoglobinLevel" value="Pass" type="varchar(20)"></column>
			<where>haemoglobinLevel = 'Normal'</where>
		</update>

		<update tableName="Donation_AUD">
			<column name="haemoglobinLevel" value="Fail" type="varchar(20)"></column>
			<where>haemoglobinLevel = 'High'</where>
		</update>
		<update tableName="Donation_AUD">
			<column name="haemoglobinLevel" value="Fail" type="varchar(20)"></column>
			<where>haemoglobinLevel = 'Low'</where>
		</update>
		<update tableName="Donation_AUD">
			<column name="haemoglobinLevel" value="Pass" type="varchar(20)"></column>
			<where>haemoglobinLevel = 'Normal'</where>
		</update>
	</changeSet>

	<changeSet id="20160121-1424" author="debonair">
		<update tableName="Donation">
			<column name="haemoglobinLevel" value="FAIL" type="varchar(20)"></column>
			<where>haemoglobinLevel = 'Fail'</where>
		</update>
		<update tableName="Donation">
			<column name="haemoglobinLevel" value="PASS" type="varchar(20)"></column>
			<where>haemoglobinLevel = 'Pass'</where>
		</update>
		<update tableName="Donation_AUD">
			<column name="haemoglobinLevel" value="FAIL" type="varchar(20)"></column>
			<where>haemoglobinLevel = 'Fail'</where>
		</update>
		<update tableName="Donation_AUD">
			<column name="haemoglobinLevel" value="PASS" type="varchar(20)"></column>
			<where>haemoglobinLevel = 'Pass'</where>
		</update>
	</changeSet>
	
    <changeSet id="20160127-0846" author="timler">
        <comment>Rename Conf 1, Conf 2 and Conf 3 BloodTests</comment>
        <update tableName="BloodTest">
            <column name="testName" value="HIV Repeat 1" type="varchar(25)"></column>
            <column name="testNameShort" value="HIV Repeat 1" type="varchar(25)"></column>
            <where>id = 18</where>
        </update>
        <update tableName="BloodTest">
            <column name="testName" value="HIV Repeat 2" type="varchar(25)"></column>
            <column name="testNameShort" value="HIV Repeat 2" type="varchar(25)"></column>
            <where>id = 19</where>
        </update>
        <update tableName="BloodTest">
            <column name="testName" value="HIV Confirmatory" type="varchar(25)"></column>
            <column name="testNameShort" value="HIV Conf" type="varchar(25)"></column>
            <where>id = 29</where>
        </update>
        <update tableName="BloodTest">
            <column name="testName" value="HBV Repeat 1" type="varchar(25)"></column>
            <column name="testNameShort" value="HBV Repeat 1" type="varchar(25)"></column>
            <where>id = 21</where>
        </update>
        <update tableName="BloodTest">
            <column name="testName" value="HBV Repeat 2" type="varchar(25)"></column>
            <column name="testNameShort" value="HBV Repeat 2" type="varchar(25)"></column>
            <where>id = 22</where>
        </update>
        <update tableName="BloodTest">
            <column name="testName" value="HBV Confirmatory" type="varchar(25)"></column>
            <column name="testNameShort" value="HBV Conf" type="varchar(25)"></column>
            <where>id = 30</where>
        </update>
        <update tableName="BloodTest">
            <column name="testName" value="HCV Repeat 1" type="varchar(25)"></column>
            <column name="testNameShort" value="HCV Repeat 1" type="varchar(25)"></column>
            <where>id = 24</where>
        </update>
        <update tableName="BloodTest">
            <column name="testName" value="HCV Repeat 2" type="varchar(25)"></column>
            <column name="testNameShort" value="HCV Repeat 2" type="varchar(25)"></column>
            <where>id = 25</where>
        </update>
        <update tableName="BloodTest">
            <column name="testName" value="HCV Confirmatory" type="varchar(25)"></column>
            <column name="testNameShort" value="HCV Conf" type="varchar(25)"></column>
            <where>id = 31</where>
        </update>
        <update tableName="BloodTest">
            <column name="testName" value="Syphilis Repeat 1" type="varchar(25)"></column>
            <column name="testNameShort" value="Syphilis Repeat 1" type="varchar(25)"></column>
            <where>id = 27</where>
        </update>
        <update tableName="BloodTest">
            <column name="testName" value="Syphilis Repeat 2" type="varchar(25)"></column>
            <column name="testNameShort" value="Syphilis Repeat 2" type="varchar(25)"></column>
            <where>id = 28</where>
        </update>
        <update tableName="BloodTest">
            <column name="testName" value="Syphilis Confirmatory" type="varchar(25)"></column>
            <column name="testNameShort" value="Syphilis Conf" type="varchar(25)"></column>
            <where>id = 32</where>
        </update>
    </changeSet>
	
    <changeSet id="20160127-1210" author="timler">
        <comment>Add Blood Abo/Rh repeat tests</comment>
        <insert tableName="BloodTest">
            <column name="id" value="34"></column>
            <column name="bloodTestType" value="REPEAT_BLOODTYPING"></column>
            <column name="category" value="BLOODTYPING"></column>
            <column name="context" value="RECORD_BLOOD_TYPING_TESTS"></column>
            <column name="isActive" value="1"></column>
            <column name="isEmptyAllowed" value="0"></column>
            <column name="negativeResults" value=""></column>
            <column name="positiveResults" value="A,B,AB,O"></column>
            <column name="rankInCategory" value="1"></column>
            <column name="testName" value="ABO Repeat 1"></column>
            <column name="testNameShort" value="ABO Repeat 1"></column>
            <column name="validResults" value="A,B,AB,O"></column>
            <column name="isDeleted" value="0"></column>
        </insert>
        <insert tableName="BloodTest">
            <column name="id" value="35"></column>
            <column name="bloodTestType" value="REPEAT_BLOODTYPING"></column>
            <column name="category" value="BLOODTYPING"></column>
            <column name="context" value="RECORD_BLOOD_TYPING_TESTS"></column>
            <column name="isActive" value="1"></column>
            <column name="isEmptyAllowed" value="0"></column>
            <column name="negativeResults" value="NEG"></column>
            <column name="positiveResults" value="POS"></column>
            <column name="rankInCategory" value="1"></column>
            <column name="testName" value="Rh Repeat 1"></column>
            <column name="testNameShort" value="Rh Repeat 1"></column>
            <column name="validResults" value="POS,NEG"></column>
            <column name="isDeleted" value="0"></column>
        </insert>
        <sql>
            UPDATE BloodTestingRule SET pendingTestsIds = '34' WHERE id in ('1','2','3','4');
            UPDATE BloodTestingRule SET pendingTestsIds = '35' WHERE id in ('5', '6');
        </sql>
    </changeSet>
    
    <changeSet id="20160202-1133" author="bausmeier">
        <update tableName="GeneralConfig">
            <column name="name" value="testing.deferDonorsWithNegRepeatOutcomes" type="varchar(255)"></column>
            <column name="description" value="Defer donors with a POS TTI test outcome, where all repeat outcomes are NEG" type="varchar(255)"></column>
            <where>name = "testing.deferDonorsWithNegConfirmatoryOutcomes"</where>
        </update>
    </changeSet>
    
    <changeSet id="20160218-0901" author="timler">
        <comment>Add NT (NOT-TESTED) as a valid option for confirmatory blood tests</comment>
        <sql>
            UPDATE BloodTest SET validResults = 'POS,NEG,NT' WHERE id in (29,30,31,32);
        </sql>
    </changeSet>

	<!-- fix foreign key bug (originated in db-fix-ids.xml) -->
	<changeSet id="20160301-1124" author="timler">
		<preConditions onFail="MARK_RAN">
			<changeSetExecuted id="20151209-1510" author="timler" changeLogFile="./liquibase/db-fix-ids.xml" />
		</preConditions>
		<comment>Fix foreign key reference BloodTest_WorksheetType - BloodTest</comment>
		<dropForeignKeyConstraint baseTableName="BloodTest_WorksheetType"
			constraintName="fk_BloodTest_WorksheetType_worksheetTypes_id" />
		<addForeignKeyConstraint constraintName="fk_BloodTest_WorksheetType_worksheetTypes_id"
			baseColumnNames="worksheetTypes_id" baseTableName="BloodTest_WorksheetType"
			referencedColumnNames="id" referencedTableName="WorksheetType" />
	</changeSet>

	<!-- delete Weak D test -->
	<changeSet id="20160301-0925" author="timler">
		<preConditions onFail="MARK_RAN">
			<not>
				<sqlCheck expectedResult="0"> 
				<![CDATA[
				SELECT count(*) FROM BloodTest WHERE testNameShort = 'Weak D';
				]]>
				</sqlCheck>
			</not>
		</preConditions>
		<comment>Remove Weak D test (and delete all results)</comment>
		<!-- hard delete the test results -->
		<sql>
			DELETE FROM BloodTestResult WHERE bloodTest_id = (SELECT id from
			BloodTest where testNameShort = 'Weak D');
		</sql>
		<delete tableName="BloodTest_WorksheetType">
			<where>bloodTests_id = (SELECT id from BloodTest where testNameShort = 'Weak D')</where>
		</delete>
		<!-- finally ... delete the Weak D test -->
		<delete tableName="BloodTest">
			<where>testNameShort = 'Weak D'</where>
		</delete>
	</changeSet>
	
	    <changeSet id="20160307-1530" author="lauravignoli">
        <comment>Update some maxLength on FormField for Donor</comment>
        <sql>
            UPDATE FormField SET maxLength = 20 WHERE form = 'Donor' AND field IN ('firstName', 'middleName', 'lastName', 'callingName');
            UPDATE FormField SET isRequired = true WHERE form = 'Donor' AND field = 'preferredLanguage';       
        </sql>
        <insert tableName="FormField">
			<column name="form" value="Donor"></column>
			<column name="FIELD" value="venue"></column>
			<column name="defaultDisplayName" value="Venue"></column>
			<column name="defaultValue" value=""></column>
			<column name="maxLength" value="0"></column>
			<column name="hidden" value="0"></column>
			<column name="isHidable" value="1"></column>
			<column name="isRequired" value="1"></column>
			<column name="canBeOptional" value="1"></column>
			<column name="autoGenerate" value="0"></column>
			<column name="isAutoGeneratable" value="0"></column>
			<column name="useCurrentTime" value="0"></column>
			<column name="isTimeField" value="0"></column>
		</insert>
    </changeSet>

    <changeSet id="20160315-1355" author="bausmeier">
        <comment>Add NT (NOT-TESTED) as a valid option for titre and antibody screening blood tests</comment>
        <sql>
            UPDATE BloodTest SET validResults = CONCAT(validResults, ',NT') WHERE id IN (3, 33);
        </sql>
    </changeSet>
	
    <changeSet id="20160309-1132" author="timler">
        <comment>Removed useParametersFromBatch from Donation FormFields</comment>
        <delete tableName="FormField">
            <where>form = 'donation' and field = 'useParametersFromBatch'</where>
        </delete>
    </changeSet>

	<changeSet id="20160404" author="debonair">
		<comment>Add view donations, view donation information and view donation batch roles to Donor Counselling Staff</comment>
		<insert tableName="Permission_Role">
			<column name="permissions_id" value="15"></column>
			<column name="roles_id" value="6"></column>
		</insert>
		<insert tableName="Permission_Role">
			<column name="permissions_id" value="60"></column>
			<column name="roles_id" value="6"></column>
		</insert>
		<insert tableName="Permission_Role">
			<column name="permissions_id" value="70"></column>
			<column name="roles_id" value="6"></column>
		</insert>
	</changeSet>

</databaseChangeLog>
